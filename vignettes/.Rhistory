library(bis557)
library(devtools)
library(testthat)
library(bis557)
test()
library(bis557)
fit <- linear_model(Sepal.Length ~ ., iris)
#summary(fit)
library(bis557)
data(ridge_train)
fit<-ridge_reg(Sepal.Length ~ .,1.2, iris)
install.packages("glmnet")
library(glmnet)
# KKT check function
check_kkt <- function(y, X, b, lambda) {
resids <- y - X %*% b
s <- apply(X, 2, function(xj) crossprod(xj, resids)) / lambda / nrow(X)
(b == 0) & (abs(s) >= 1)
}
# use iris as dataset
x <- scale(model.matrix(Sepal.Length ~. -1, iris))
y <- iris[,1]
# implement lasso (set alpha to 0)
lasso_reg_with_screening <- function(x, y){
m1 <- cv.glmnet(x,y,alpha=1)
lambda <- m1$lambda.1se
b <- m1$glmnet.fit$beta[, m1$lambda == lambda]
print(b)
check_kkt(y, x, b, lambda)
}
lasso_reg_with_screening(x, y)
